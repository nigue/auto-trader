<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            if (typeof faces !== 'undefined' &amp;&amp; faces.ajax) {
                console.log('El objeto faces está disponible.');
            } else {
                console.error('El objeto faces no está disponible.');
            }
        });
        function ajax(data) {
            var status = data.status;
            if (status == "begin") {
                setInterval(function () {
                    var progressValue = document.getElementById("progress").innerHTML;
                    if (progressValue != '100%') {
                        document.getElementById("form:refresh").click();
                    }

                }, 1000);
            }
        }
    </script>
</h:head>
<h:body>
    <f:view>
        <h1>JavaBeat JSF 2.2 Examples</h1>
        <h2>JSF2 Ajax Monitoring Example</h2>
        <h:form id="form">
            <div id="progress-container">
                <div id="progress">#{percent.progress}%</div>
            </div>
            <br/>
            <br/>
            <br/>
            <h:commandButton value="Do process" action="#{percent.doProgress()}">
                <f:ajax render="@form" onevent="ajax"/>
            </h:commandButton>
            <h:commandButton value="Refresh" id="refresh" style="display: none;">
                <f:ajax render="@form"/>
            </h:commandButton>
        </h:form>  
    </f:view>
</h:body>
</html>
